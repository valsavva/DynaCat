<?xml version="1.0" encoding="utf-8" ?>
<!--<Level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="file:///D:/Lunohod/Documentation/schema0.xsd" Name="AlphaTest5ME" Bounds="0, 0, 480, 320">-->
<Include>
    <Resources RootFolder="Textures">
        <Texture Id="txr_magnet_excavator" Source="magnet_excavator" />
        <Texture Id="txr_magnet_waves" Source="magnet_waves" />
    </Resources>

    <Class Id="clsExcavator">
        <Group>
            <Do Action="@this_dirX=@paramDirX;@this_dirY=@paramDirY;" InProgress="true" />

            <!-- horizontal, shooting right -->
            <BoolTrigger Condition="@this_dirX==1">
                <Do Action="this_blkExcavator.X=0;
                    this_grpMagnetWaves.SetBounds(this_blkExcavator.Width, 5, this.Width-this_blkExcavator.Width, 30);"
                    RepeatCount="0" InProgress="true"
                />
            </BoolTrigger>
            <!-- horizontal, shooting left -->
            <BoolTrigger Condition="@this_dirX==-1">
                <Do Action="this_blkExcavator.X=this.Width-this_blkExcavator.Width;
                    this_grpMagnetWaves.SetBounds(0, 5, this.Width-this_blkExcavator.Width, 30);"
                    RepeatCount="0" InProgress="true"
                />
            </BoolTrigger>

        
            <Block Id="this_blkExcavator" Edges="Stick" Bounds="0, 0, 60, 40">
                <Image TextureId="txrEnemyRat3Default" Location="14, 2"/>
                <Image TextureId="txr_magnet_excavator"/>
            </Block>
    
            <Group Id="this_grpMagnetWaves">
                <SequenceSet RepeatCount="0" InProgress="true" >
                    <!--<Do Action="this_grpMagnetWaves.Enable()" />-->
                    <Do Action="this:+IsBeaming" />
                    <NumAnimation Target="this_grpMagnetWaves.Opacity" Autoreverse="true" From="0.8" To="0.3" Duration="0.1" Smoothing="Smooth" RepeatCount="25"/>
                    <Do Action="this_grpMagnetWaves.Opacity=0;this:-IsBeaming;hero:-Magneted;hero:-Magneting" />
                    <!--<Do Action="this_grpMagnetWaves.Disable()" />-->
                    <Delay Duration="2" />
                </SequenceSet>
                <Image Id="this_imgBeam" TextureId="txr_magnet_waves" StretchMode="Tile"/>
            </Group>

            <IntersectionTrigger ObjectId1="this_grpMagnetWaves" ObjectId2="hero">
                <BoolTrigger Condition="this:IsBeaming" EnterAction="hero:+Magneted;this_anmSetHeroOnCenter.Start()" ExitAction="hero:-Magneted;hero:-Magneting;this_anmSetHeroOnCenter.Pause()"/>
            </IntersectionTrigger>

            <SequenceSet Id="this_anmSetHeroOnCenter" RepeatCount="1" >
                <NumAnimation Target="hero.Y" From="hero.Y" To="this.Y+8" Duration="0.5" RepeatCount="1" Fill="End"/>
                <Do Action="hero:+Magneting;hero.SetDirection(-1*@this_dirX,-1*@this_dirY)" />
            </SequenceSet>


        </Group>
    </Class>
</Include>
