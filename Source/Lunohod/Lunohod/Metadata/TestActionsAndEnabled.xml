<?xml version="1.0" encoding="utf-8" ?>
<Level Name="AnimationSamples.xml" Bounds="0,0,480,320">

	<Include File="Textures.xml" />

	<!-- ========================================================================================= -->
	<!-- clsHeroCursor -->
	<!-- ========================================================================================= -->
	<Class Id="clsHeroCursor">
		<Hero Direction="0,0" Speed="44">
			<BoolTrigger Id="default">
				<Image TextureId="cursor_50x50_blue"/>
			</BoolTrigger>
		</Hero>
	</Class>

	<!-- ========================================================================================= -->
	<!-- clsAbr -->
	<!-- ========================================================================================= -->
	<Class Id="clsAbr">
		<Enemy>
			<IntersectionTrigger ObjectId2="this" ObjectId1="hero" EnterAction="setRunAway.Start();setPickColor.Start" Group="enemyStates">
				<!-- Выбираем случайно куда бежать -->
				<!-- Если Probabilities одинаковые, то их можно не указывать. -->
				<!-- По умолчанию у сэтов RepeatCount - единица. То есть, они исполняются один раз после запуска.
				   Но мы хотим чтобы этот исполнялся постоянно (запускал новую анимацию, как только старая заканчивается). -->
				<RandomSet Id="setRunAway" RepeatCount="0">
					<NumAnimation InProgress="true" RepeatCount="1" Fill="Hold" Target="this.X,this.Y" IsDelta="true" Autoreverse="false" Duration="1" To="-100,0" From="0,0"/>
					<NumAnimation InProgress="true" RepeatCount="1" Fill="Hold" Target="this.X,this.Y" IsDelta="true" Autoreverse="false" Duration="1" To="100,0" From="0,0"/>
					<NumAnimation InProgress="true" RepeatCount="1" Fill="Hold" Target="this.X,this.Y" IsDelta="true" Autoreverse="false" Duration="1" To="0,-100" From="0,0"/>
					<NumAnimation InProgress="true" RepeatCount="1" Fill="Hold" Target="this.X,this.Y" IsDelta="true" Autoreverse="false" Duration="1" To="0,100" From="0,0"/>
				</RandomSet>

				<!-- Этот выберет цвет для убегания.-->
				<SequenceSet Id="setPickColor">
					<!-- Гасим все имиджи -->
					<Do Action="aa1.Disable();aa2.Disable();aa3.Disable();aa4.Disable()" />
					<!-- Выбираем случайный -->
					<RandomSet>
						<Do Action="aa1.Enable()" />
						<Do Action="aa2.Enable()" />
						<Do Action="aa3.Enable()" />
						<Do Action="aa4.Enable()" />
					</RandomSet>
				</SequenceSet>

				<!-- Цвета на выбор. Размещаем их после сэтов, чтобы отрисовывались сразу на первом апдэйте. -->				
				<Image Id="aa1" TextureId="cursor_50x50_light_blue" />
				<Image Id="aa2" TextureId="cursor_50x50_green" />
				<Image Id="aa3" TextureId="cursor_50x50_blue" />
				<Image Id="aa4" TextureId="cursor_50x50_red" />
			</IntersectionTrigger>
			
			<BoolTrigger Id="this_default" Group="enemyStates">
				<Image Id="imgN2" TextureId="cursor_50x50_green"> </Image>
			</BoolTrigger>
		</Enemy>
	</Class>

	<Layer Id="background" BackColor="#FFFFFFFF">
		<Image TextureId="white_clear" Bounds="0, 0, 480, 320" Stretch="true" Opacity="1" />
		<Image TextureId="grid_480x320" Bounds="0, 0, 480, 320" Stretch="false" Opacity="1"/>
	</Layer>

	<Layer Id="action" BackColor="#FFFFFFFF">
		<Block Id="blk1" Bounds="0,0,480,1" Edges="Bounce" />
		<Block Id="blk2" Bounds="480,0,1,320" Edges="Bounce" />
		<Block Id="blk3" Bounds="0,320,480,1" Edges="Bounce" />
		<Block Id="blk4" Bounds="0,0,1,320" Edges="Bounce" />

		<Tower Bounds="0,0,35,35" SignalSpeed="1800"/>
		
		<Hero Id="hero" Bounds="50,150,50,50" Class="clsHeroCursor" />

		<Enemy Id="abr101" Bounds="250, 160, 10, 10" Class="clsAbr" />

	</Layer>

	<Include File="Dashboard.xml" />

</Level>

