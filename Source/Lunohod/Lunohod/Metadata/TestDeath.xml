<?xml version="1.0" encoding="utf-8" ?>
<Level Name="TextText" Bounds="0,0,480,320">
	<Resources RootFolder="Sound">
		<SoundFile Id="skeletonFX_crash_1" Source="skeletonFX_crash_1"/>
	</Resources>
	<Resources RootFolder="Global">
		<Texture Id="blank" Source="blank" />
		<Font Id="SystemFont" Source="SystemFont" />
	</Resources>
	<Include File="Textures.xml" />

	<!-- health meter -->	
	<Class Id="clsLifeMeter">
		<Group Opacity="0.5">
			<NumTrigger Property="hero.Health" Compare="GE" Value="5" Group="meterStates">
				<Image TextureId="blank" Bounds="0,0,100,20" BackColor="#00FF00"/>
			</NumTrigger> 
			<NumTrigger Property="hero.Health" Compare="GE" Value="4" Group="meterStates">
				<Image TextureId="blank" Bounds="0,0,80,20" BackColor="#22DD00"/>
			</NumTrigger> 
			<NumTrigger Property="hero.Health" Compare="GE" Value="3" Group="meterStates">
				<Image TextureId="blank" Bounds="0,0,60,20" BackColor="#888800"/>
			</NumTrigger> 
			<NumTrigger Property="hero.Health" Compare="GE" Value="2" Group="meterStates">
				<Image TextureId="blank" Bounds="0,0,40,20" BackColor="#CC3300"/>
			</NumTrigger> 
			<NumTrigger Property="hero.Health" Compare="GE" Value="1" Group="meterStates">
				<Image TextureId="blank" Bounds="0,0,20,20" BackColor="#FF0000"/>
			</NumTrigger> 
			<BoolTrigger Group="meterStates">
				<!-- need to draw a thumbstone, but I'm too lazy :) -->
				<Image TextureId="blank" Bounds="0,0,20,20" BackColor="#000000"/>
			</BoolTrigger>
		</Group>
	</Class>
	
	<Class Id="clsHero">
		<Hero Speed="220" Direction="1,0">
			<!-- We check the new IsDead property. It turns true when hero's health level goes 0 or less. -->
			<BoolTrigger Condition="this.IsDead" EnterAction="this_setDying.Start()" StayTriggered="true" Group="heroStates">
				<Image Id="this_img1" TextureId="cursor_50x50_light_blue"/>
				<SequenceSet Id="this_setDying">
					<Do Action="hero.StartTransaction()"/>
					<ParallelSet>
						<Sound FileId="skeletonFX_crash_1" Volume="0.5" Pitch="0" Pan="0" InProfress="true"/>
						<NumAnimation Duration="0.1" Target="this_img1.Opacity" Autoreverse="true" From="1" To="0" RepeatCount="5"/>
					</ParallelSet>
					<Do Action="hero.EndTransaction()"/>
					<Do Action="system.EndLevel()"/>
				</SequenceSet>
			</BoolTrigger>
			
			<BoolTrigger Id="default" Group="heroStates">
				<Image TextureId="cursor_50x50_blue"/>
			</BoolTrigger>
		</Hero>
	</Class>

	<Class Id="clsEnemy">
		<!-- Our enemy has a damage level of 1. That's how badly we hurt hero when we attack him -->
		<Enemy Damage="1">
			<!-- When hero and enemy intersect, enemy attacks hero once. -->
   			<IntersectionTrigger ObjectId1="hero" ObjectId2="this" EnterAction="this.Attack()" Group="enemyStates">
				<Image TextureId="cursor_50x50_red"/>
			</IntersectionTrigger>
			<BoolTrigger Id="this_default" Group="enemyStates">
				<Image TextureId="cursor_50x50_purple"/>
			</BoolTrigger>
		</Enemy>
	</Class>
	
	<Layer Id="action" BackColor="#FFFFFFFF">
		<Block Id="blk1" Bounds="0,0,480,1" Edges="Bounce" />
		<Block Id="blk2" Bounds="480,0,1,320" Edges="Bounce" />
		<Block Id="blk3" Bounds="0,320,480,1" Edges="Bounce" />
		<Block Id="blk4" Bounds="0,0,1,320" Edges="Bounce" />

		<Tower Bounds="0,0,35,35" SignalSpeed="400"/>

		<Hero Id="hero" Bounds="50,150,50,50" Class="clsHero"/>
		
		<Enemy Id="enemy" Bounds="250,150,50,50" Class="clsEnemy"/>

		<Group Id="lifeMeter" Bounds="10,10,100,20" Class="clsLifeMeter"/>
	</Layer>

	<Include File="Dashboard.xml" />

</Level>

