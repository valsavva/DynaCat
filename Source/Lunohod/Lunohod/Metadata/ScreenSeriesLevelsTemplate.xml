<?xml version="1.0" encoding="UTF-8" ?>

<Include>
    <Include File="ClassUIMovingBackground.xml" />
    <Include File="ClassUIButton.xml" />

    <Resources RootFolder="Global">
        <Texture Id="txrBackground" Source="select_level_BG" />
        <Texture Id="txrSelectLevelText" Source="select_level_txt" />
        <Texture Id="txrPanels" Source="select_level_panels" />
        <Texture Id="txrStar" Source="select_level_panel_star" />
        <Texture Id="txrBadge" Source="select_level_panel_beydg" />
        <Texture Id="txrNumbers" Source="numbers" />
    </Resources>

	<Class Id="clsLevelButton">
		<Group>
			<Do Action="
				@this_levelExists=system.GetSeriesLevelName(@seriesNum,@levelNum)!='';
				"
				InProgress="true"
				RepeatCount="1"
			/>
			<BoolTrigger Condition="@this_levelExists">
				<Do Action="
					this_sprPanel.CurrentFrame=system.Rnd(0,4);
					this_sprNumber1.CurrentFrame=system.IIf((@levelNum+1)>=10,system.Truncate((@levelNum+1)/10),@levelNum+1);
					this_sprNumber2.CurrentFrame=(@levelNum+1)%10;
					this_sprNumber2.Enabled=(@levelNum+1)>=10;
					"
					InProgress="true"
					RepeatCount="1"
				/>
			
				<Do Action="
					@this_numberOfStars=system.GetSeriesLevelStars(@seriesNum,@levelNum);
					@this_hasBadge=system.GetSeriesLevelHasBadge(@seriesNum,@levelNum);
					@this_previosLevelScore=777;
					"
					InProgress="true"
					RepeatCount="0"
				/>
				
				<BoolTrigger Condition="@levelNum>0" Action="@this_previosLevelScore=system.GetSeriesLevelScore(@seriesNum,@levelNum-1);" />
				
	            <SequenceSet Id="this_setPress">
	                <NumAnimation Target="this.Scale" From="1" To="1.1" Duration="0.2" Autoreverse="true" RepeatCount="1"/>
	                <Do Action="system.StartSeriesLevel(@seriesNum,@levelNum)"/>
	            </SequenceSet>
	            
	            <BoolTrigger Condition="@this_previosLevelScore > 0">
					<TapArea Action="this_setPress.Start()"/>
	            </BoolTrigger>

	            <BoolTrigger Condition="@this_previosLevelScore == 0"
	            	EnterAction="
	            	this_sprPanel.SetBackColor(255,200,200,200);
	            	this_sprNumber1.SetBackColor(255,200,200,200);
	            	this_sprNumber2.SetBackColor(255,200,200,200);
	            	"
	            	ExitAction="
	            	this_sprPanel.SetBackColor(255,255,255,255);
	            	this_sprNumber1.SetBackColor(255,255,255,255);
	            	this_sprNumber2.SetBackColor(255,255,255,255);
	            	"
            	/>

				<Group Id="this_grpLevelPanel">
	            	<Sprite Id="this_sprPanel" TextureId="txrPanels" Bounds="0,0,94,51" FrameBounds="0,0,94,51" FrameCount="2"/>
		            <Sprite Id="this_sprNumber1" TextureId="txrNumbers" Bounds="5,5,32,32" FrameBounds="0,0,32,32"/>
		            <Sprite Id="this_sprNumber2" TextureId="txrNumbers" Bounds="27,5,32,32" FrameBounds="0,0,32,32"/>
	            </Group>
	            
	            <BoolTrigger Condition="@this_numberOfStars>0">
	            	<Image TextureId="txrStar" Location="24,32" />
	            </BoolTrigger>
	            <BoolTrigger Condition="@this_numberOfStars>1">
	            	<Image TextureId="txrStar" Location="37,32" />
	            </BoolTrigger>
	            <BoolTrigger Condition="@this_numberOfStars>2">
	            	<Image TextureId="txrStar" Location="50,32" />
	            </BoolTrigger>
	            
	            <BoolTrigger Condition="@this_hasBadge">
	            	<Image TextureId="txrBadge" Location="50,0" />
	            </BoolTrigger>
	            
			</BoolTrigger>
		</Group>
	</Class>

	<Class Id="clsLevelsLayer">
		<Layer Id="action" BackColor="#FFFFFFFF">

			<Do Action="
				@seriesNum=@layerSeriesNum;
				@numberOfLevels=system.GetSeriesLevelCount(@layerSeriesNum);
				@currentPage=0;
				@numberOfPages=system.Ceiling(@numberOfLevels/16);
				"
				InProgress="true"
			/>
			
			<Group Class="clsMovingBackground" ClassParams="@textureIdParam=txrBackground" />
			<Group Id="grpScreen0" Bounds="045,040,500,500">
				<BoolTrigger Condition="@currentPage==0">
					<Group Id="grpL00" Bounds="000,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=00"/>
					<Group Id="grpL01" Bounds="100,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=01"/>
					<Group Id="grpL02" Bounds="200,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=02"/>
					<Group Id="grpL03" Bounds="300,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=03"/>

					<Group Id="grpL04" Bounds="000,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=04"/>
					<Group Id="grpL05" Bounds="100,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=05"/>
					<Group Id="grpL06" Bounds="200,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=06"/>
					<Group Id="grpL07" Bounds="300,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=07"/>

					<Group Id="grpL08" Bounds="000,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=08"/>
					<Group Id="grpL09" Bounds="100,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=09"/>
					<Group Id="grpL10" Bounds="200,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=10"/>
					<Group Id="grpL11" Bounds="300,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=11"/>

					<Group Id="grpL12" Bounds="000,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=12"/>
					<Group Id="grpL13" Bounds="100,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=13"/>
					<Group Id="grpL14" Bounds="200,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=14"/>
					<Group Id="grpL15" Bounds="300,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=15"/>
				</BoolTrigger>
				<BoolTrigger Condition="@currentPage==1">
					<Group Id="grpL16" Bounds="000,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=16"/>
					<Group Id="grpL17" Bounds="100,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=17"/>
					<Group Id="grpL18" Bounds="200,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=18"/>
					<Group Id="grpL19" Bounds="300,000,095,050" Class="clsLevelButton" ClassParams="@levelNum=19"/>

					<Group Id="grpL20" Bounds="000,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=20"/>
					<Group Id="grpL21" Bounds="100,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=21"/>
					<Group Id="grpL22" Bounds="200,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=22"/>
					<Group Id="grpL23" Bounds="300,057,095,050" Class="clsLevelButton" ClassParams="@levelNum=23"/>

					<Group Id="grpL24" Bounds="000,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=24"/>
					<Group Id="grpL25" Bounds="100,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=25"/>
					<Group Id="grpL26" Bounds="200,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=26"/>
					<Group Id="grpL27" Bounds="300,114,095,050" Class="clsLevelButton" ClassParams="@levelNum=27"/>

					<Group Id="grpL28" Bounds="000,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=28"/>
					<Group Id="grpL29" Bounds="100,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=29"/>
					<Group Id="grpL30" Bounds="200,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=30"/>
					<Group Id="grpL31" Bounds="300,171,095,050" Class="clsLevelButton" ClassParams="@levelNum=31"/>
				</BoolTrigger>
			</Group>
            <Image TextureId="txrSelectLevelText" Location="125,5" />
			<Group Id="this_btnBack" Class="clsButton" ClassParams="@BtnImg=5" Bounds="50, 256, 62, 62">
			    <BoolTrigger Condition="this_btnBack:Action" EnterAction="system.CloseCurrentScreen();" />
			</Group>
			<Group Id="this_btnPrevPage" Class="clsButton" ClassParams="@BtnImg=1" Bounds="173, 256, 62, 62">
			    <BoolTrigger Condition="this_btnPrevPage:Action" EnterAction="@currentPage=system.IIf((@currentPage-1)&lt;0,0,@currentPage-1);" />
			</Group>
			<Group Id="this_btnNextPage" Class="clsButton" ClassParams="@BtnImg=8" Bounds="245, 256, 62, 62">
			    <BoolTrigger Condition="this_btnNextPage:Action" EnterAction="@currentPage=system.IIf((@currentPage+1)>=(@numberOfPages-1),@numberOfPages-1,@currentPage+1);" />
			</Group>
		</Layer>
	</Class>	
</Include>