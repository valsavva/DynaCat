<Include>

    <Resources RootFolder="Sound">
        <SoundFile Id="sndParachute_open" Source="parachute_open"/>
    </Resources>
    <Resources RootFolder="Textures">
        <Texture Id="txr_parachute" Source="parachute" />
    </Resources>

    <Class Id="clsEnemyRat1">
		<Enemy IsExploding="true" Damage="30" Points="75"> <!-- Damage="9" -->
            
<!-- Points Animation -->
            <Group Id="this_grpShowPoints" Bounds="0,0,100,50" IsRoot="true" Depth="0.2" Enabled="false">
                <Do Action="this_grpShowPoints.X=this.X;this_grpShowPoints.Y=this.Y" InProgress="true" />
                <Text FontId="Splash14Font" Text="='+' + system.Str(this.Points)" Location="6,-12" Color="#FFFFFF">
                    <SequenceSet RepeatCount="1" InProgress="true">
                        <ParallelSet RepeatCount="1">
                            <NumAnimation Target="this_grpShowPoints.Opacity" From="1" To="0.5" RepeatCount="1" Duration="1" Fill="Hold" />
                            <RandomSet RepeatCount="1" >
                                <NumAnimation Target="this_grpShowPoints.Y" From="0" To="-50" IsDelta="true" RepeatCount="1" Duration="1" Fill="Hold" />
                                <NumAnimation Target="this_grpShowPoints.Y" From="0" To="-40" IsDelta="true" RepeatCount="1" Duration="1" Fill="Hold" />
                            </RandomSet>
                            <RandomSet RepeatCount="1" >
                                <NumAnimation Target="this_grpShowPoints.X" From="-4" To="4" IsDelta="true" Autoreverse="true" RepeatCount="1.25" Duration="0.4" Fill="Hold" />
                                <NumAnimation Target="this_grpShowPoints.X" From="4" To="-4" IsDelta="true" Autoreverse="true" RepeatCount="1.25" Duration="0.4" Fill="Hold" />
                            </RandomSet>
                        </ParallelSet>
                        <Do Action="this.Disable()"/>
                    </SequenceSet>
                </Text>
            </Group>

            <Image Id="this_imgCloud1" TextureId="txrCloud1" Bounds="-3, 1, 32, 23" Enabled="false"/>

<!-- Parachute animation-->

            <BoolTrigger Condition="tower:LevelWithParachutes" EnterAction="this.Y=this.Y-60;this.Opacity=0">
                <Image Id="this_imgParachute" TextureId="txr_parachute" Bounds="-14, -44, 50, 50"/>
                <SequenceSet InProgress="true">
                    <Delay Duration="system.Rnd(1,2)" />
                    <Do Action="this.Opacity=1" />
                    <ParallelSet>
                        <Sound FileId="sndParachute_open" Volume="0.2" Pitch="0" Pan="0"/>
                        <NumAnimation Target="this.Y" From="0" To="60" IsDelta="true" Autoreverse="false" RepeatCount="1" Duration="1.6" Fill="End" />
                        <SequenceSet InProgress="true" RepeatCount="2" >
                            <NumAnimation Target="this.Rotation" From="0" To="-2" Autoreverse="true" Duration="0.2" Fill="End" RepeatCount="1" Smoothing="Smooth"/>
                            <NumAnimation Target="this.Rotation" From="0" To="2" Autoreverse="true" Duration="0.2" Fill="End" RepeatCount="1" Smoothing="Smooth"/>
                        </SequenceSet>
                    </ParallelSet>
                    <NumAnimation Target="this_imgParachute.Opacity" From="1" To="0" IsDelta="false" Autoreverse="false" RepeatCount="1" Duration="0.4" Fill="End" />
                    <Do Action="this_imgParachute.Disable()" />
                </SequenceSet>
            </BoolTrigger>

<!-- States -->

            <!-- explosion -->
            <!-- dying -->
			<BoolTrigger Condition="this:BoomClose" EnterAction="hero.AddScore(this.Points);this_setDying.Start()" StayTriggered="true" Group="this_sttStates">
				<Image Id="this_imgEnemyRat1Dying" TextureId="txrEnemyRat1Dying" Bounds="-6, -2, 40, 29"/>
			</BoolTrigger>
            <ParallelSet Id="this_setDying" InProgress="false">
                <Do Action="hero:+sttGoodExplosion;this_grpShowPoints.Enable()"/>
                <Sound FileId="sndEnemyRat1Dying" Volume="0.5" Pitch="0" Pan="0" InProfress="true"/>
                <NumAnimation Target="this_imgEnemyRat1Dying.Opacity" From="1" To="0" Duration="0.2" Autoreverse="false" RepeatCount="1" Fill="End"/>
                <SequenceSet>
                    <Do Action="this_imgCloud1.Enable()" />
                    <NumAnimation Target="this_imgCloud1.Opacity" From="1" To="0" Duration="0.5" Autoreverse="false" RepeatCount="1" Fill="End"/>
                </SequenceSet>
            </ParallelSet>

			<!-- attack -->
            <BoolTrigger Condition="hero.CanCollide and not this_grpShowPoints.Enabled">
                <IntersectionTrigger ObjectId1="hero" ObjectId2="this" EnterAction="this.Attack();this.Attack();this_anmDamageDealing.Start()" ExitAction="this_anmDamageDealing.Stop()" Action="hero:sttGottaDamage" Group="this_sttStates">
                    <Image Id="this_txrEnemyRat1Attack" TextureId="txrEnemyRat1Attack" Bounds="-6, -2, 40, 29"/>
                </IntersectionTrigger>
            </BoolTrigger>

            <SequenceSet Id="this_anmDamageDealing" RepeatCount="0">
                <Do Action="this_anmAttack.Start()" />
                <Delay Duration="system.Rnd(0.5,1)" />
            </SequenceSet>

            <ParallelSet Id="this_anmAttack" RepeatCount="1">
                <Do Action="this.Attack()" />
                <RandomSet>
                    <Sound FileId="sndEnemyRat1Hit1" Volume="0.5" Pitch="0" Pan="0"/>
                    <Sound FileId="sndEnemyRat1Hit2" Volume="0.5" Pitch="0" Pan="0"/>
                    <Sound FileId="sndEnemyRat1Hit3" Volume="0.5" Pitch="0" Pan="0"/>
                    <Sound FileId="sndEnemyRat1Hit1" Volume="0.5" Pitch="0.1" Pan="0"/>
                    <Sound FileId="sndEnemyRat1Hit2" Volume="0.5" Pitch="0.1" Pan="0"/>
                    <Sound FileId="sndEnemyRat1Hit3" Volume="0.5" Pitch="0.1" Pan="0"/>
                </RandomSet>
                <NumAnimation Duration="0.1" Target="this_txrEnemyRat1Attack.Opacity" Autoreverse="true" From="1" To="0" RepeatCount="5"/>
            </ParallelSet>
            
			<!-- default -->
			<BoolTrigger Group="this_sttStates">
				<Image Id="this_txrEnemyRat1Default" TextureId="txrEnemyRat1Default" Bounds="-6, -2, 40, 29"/>
                <!--<Image TextureId="blank" BackColor="#00FF00" Opacity="0.5"/>-->
			</BoolTrigger>
			
		</Enemy>
	</Class>

</Include>















